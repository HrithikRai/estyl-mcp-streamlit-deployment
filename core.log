2025-09-02 23:00:17,925 [DEBUG] Initializing server 'Estyl Retriever'
2025-09-02 23:00:17,925 [DEBUG] Registering handler for ListToolsRequest
2025-09-02 23:00:17,925 [DEBUG] Registering handler for CallToolRequest
2025-09-02 23:00:17,925 [DEBUG] Registering handler for ListResourcesRequest
2025-09-02 23:00:17,925 [DEBUG] Registering handler for ReadResourceRequest
2025-09-02 23:00:17,925 [DEBUG] Registering handler for PromptListRequest
2025-09-02 23:00:17,925 [DEBUG] Registering handler for GetPromptRequest
2025-09-02 23:00:17,925 [DEBUG] Registering handler for ListResourceTemplatesRequest
2025-09-02 23:00:17,937 [DEBUG] Using proactor: IocpProactor
2025-09-02 23:01:03,638 [DEBUG] Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-09-02 23:01:03,639 [DEBUG] Received message: <mcp.shared.session.RequestResponder object at 0x00000270829B0740>
2025-09-02 23:01:03,639 [INFO] Processing request of type CallToolRequest
2025-09-02 23:01:03,639 [DEBUG] Dispatching request of type CallToolRequest
2025-09-02 23:01:03,639 [DEBUG] Tool cache miss for estyl_retrieve, refreshing cache
2025-09-02 23:01:03,640 [DEBUG] Response sent
2025-09-02 23:01:13,511 [DEBUG] Received message: <mcp.shared.session.RequestResponder object at 0x0000027082A4FF20>
2025-09-02 23:01:13,511 [INFO] Processing request of type CallToolRequest
2025-09-02 23:01:13,511 [DEBUG] Dispatching request of type CallToolRequest
2025-09-02 23:01:13,512 [DEBUG] Response sent
2025-09-02 23:01:37,584 [DEBUG] Received message: <mcp.shared.session.RequestResponder object at 0x0000027082A4FC20>
2025-09-02 23:01:37,584 [INFO] Processing request of type CallToolRequest
2025-09-02 23:01:37,584 [DEBUG] Dispatching request of type CallToolRequest
2025-09-02 23:01:37,585 [DEBUG] >>> estyl_retrieve called with args: {'mode': 'outfit', 'text_query': 'old money style', 'gender': 'male', 'categories': ['shoes', 'pants', 'shirts', 'jackets', 'accessories'], 'search_with': 'Text', 'image_b64': None, 'brand_contains': None, 'budget_tier': 'Budget', 'budget': 100.0, 'limit': 10, 'topk_for_rerank': 10, 'offset': 0, 'exclude_ids': None, 'num_outfits': 5, 'articles': 5, 'per_cat_candidates': 5}
2025-09-02 23:01:37,585 [DEBUG] Resolved categories: []
2025-09-02 23:01:37,585 [DEBUG] Estyl Outfit params: OutfitParams(text_query='old money style', search_with='Text', image_b64=None, gender='male', brand_contains=None, budget_tier='Budget', budget=100.0, num_outfits=5, articles=5, per_cat_candidates=5)
2025-09-02 23:01:38,256 [DEBUG] Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-9647c483-8455-4c01-b642-838f667ad6eb', 'json_data': {'messages': [{'role': 'system', 'content': 'You output only valid JSON: a LIST of outfit objects keyed by your provided categories.'}, {'role': 'user', 'content': '\nCreate 5 outfit plans as a JSON LIST. Use these exact categories only:\n[\'Tops\', \'Bottoms\', \'Shoes\', \'Outerwear\', \'Accessories\']\n\nConstraints:\n- Event: old money style\n- Total budget (EUR): 100.0\n- Style/brand hints: \n\nOutput example (LIST):\n[\n  {"Tops": "white oxford shirt, slim fit", "Bottoms": "navy tailored trousers", "Shoes": "black leather oxford shoes"}\n]\n'}], 'model': 'gpt-4o-mini', 'temperature': 0.5}}
2025-09-02 23:01:38,295 [DEBUG] Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2025-09-02 23:01:38,295 [DEBUG] connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-09-02 23:01:38,450 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002708340FE00>
2025-09-02 23:01:38,450 [DEBUG] start_tls.started ssl_context=<ssl.SSLContext object at 0x00000270831DB750> server_hostname='api.openai.com' timeout=5.0
2025-09-02 23:01:38,550 [DEBUG] start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002708464C1D0>
2025-09-02 23:01:38,550 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-09-02 23:01:38,551 [DEBUG] send_request_headers.complete
2025-09-02 23:01:38,551 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-09-02 23:01:38,551 [DEBUG] send_request_body.complete
2025-09-02 23:01:38,551 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-09-02 23:01:43,840 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 02 Sep 2025 17:31:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'estyl'), (b'openai-processing-ms', b'4896'), (b'openai-project', b'proj_hW6ArBp4wnCsWuNcNn20BIGo'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'4906'), (b'x-ratelimit-limit-requests', b'30000'), (b'x-ratelimit-limit-tokens', b'150000000'), (b'x-ratelimit-remaining-requests', b'29999'), (b'x-ratelimit-remaining-tokens', b'149999882'), (b'x-ratelimit-reset-requests', b'2ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_ad140287b70242f791500e0da8c6f93b'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=f5Gr8gMkS2ZkEVSTZlUVAnYz5V6IcvaWesTAjzMlf1k-1756834303-1.0.1.1-zcS5kaOkt6WmvroHaJ.SX_u.c3mSls05Oww2euZ04ElSrftSs__d1rFx.kKD2oJEmYn3jRsx5m5RsigJez3yLtAGcRlg3OwjD4r8qxtjKKc; path=/; expires=Tue, 02-Sep-25 18:01:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=RNpw5FacVE4djg0OxEtLe.7je9yWCg2cCkjlhOO1bzk-1756834303525-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'978ebdfc38158a02-BOM'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-09-02 23:01:43,841 [INFO] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-02 23:01:43,842 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-09-02 23:01:43,842 [DEBUG] receive_response_body.complete
2025-09-02 23:01:43,842 [DEBUG] response_closed.started
2025-09-02 23:01:43,842 [DEBUG] response_closed.complete
2025-09-02 23:01:43,842 [DEBUG] HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 02 Sep 2025 17:31:43 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'estyl'), ('openai-processing-ms', '4896'), ('openai-project', 'proj_hW6ArBp4wnCsWuNcNn20BIGo'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '4906'), ('x-ratelimit-limit-requests', '30000'), ('x-ratelimit-limit-tokens', '150000000'), ('x-ratelimit-remaining-requests', '29999'), ('x-ratelimit-remaining-tokens', '149999882'), ('x-ratelimit-reset-requests', '2ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_ad140287b70242f791500e0da8c6f93b'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=f5Gr8gMkS2ZkEVSTZlUVAnYz5V6IcvaWesTAjzMlf1k-1756834303-1.0.1.1-zcS5kaOkt6WmvroHaJ.SX_u.c3mSls05Oww2euZ04ElSrftSs__d1rFx.kKD2oJEmYn3jRsx5m5RsigJez3yLtAGcRlg3OwjD4r8qxtjKKc; path=/; expires=Tue, 02-Sep-25 18:01:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=RNpw5FacVE4djg0OxEtLe.7je9yWCg2cCkjlhOO1bzk-1756834303525-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '978ebdfc38158a02-BOM'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2025-09-02 23:01:43,842 [DEBUG] request_id: req_ad140287b70242f791500e0da8c6f93b
2025-09-02 23:01:43,849 [DEBUG] Category 'Tops' price bounds: 0 - 18.333333333333336 (cap: 18.333333333333336) | (tier : Budget)
2025-09-02 23:01:44,113 [DEBUG] connect_tcp.started host='unv2yy07qfybxgvelndplw.c0.europe-west3.gcp.weaviate.cloud' port=443 local_address=None timeout=5.0 socket_options=None
2025-09-02 23:01:44,423 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002708464E6C0>
2025-09-02 23:01:44,423 [DEBUG] start_tls.started ssl_context=<ssl.SSLContext object at 0x000002708466B4D0> server_hostname='unv2yy07qfybxgvelndplw.c0.europe-west3.gcp.weaviate.cloud' timeout=5.0
2025-09-02 23:01:44,523 [DEBUG] start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002708464DA00>
2025-09-02 23:01:44,523 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-09-02 23:01:44,523 [DEBUG] send_request_headers.complete
2025-09-02 23:01:44,523 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-09-02 23:01:44,523 [DEBUG] send_request_body.complete
2025-09-02 23:01:44,523 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-09-02 23:01:44,929 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'access-control-allow-headers', b'Content-Type, Authorization, Batch, X-Openai-Api-Key, X-Openai-Organization, X-Openai-Baseurl, X-Anyscale-Baseurl, X-Anyscale-Api-Key, X-Cohere-Api-Key, X-Cohere-Baseurl, X-Huggingface-Api-Key, X-Azure-Api-Key, X-Azure-Deployment-Id, X-Azure-Resource-Name, X-Azure-Concurrency, X-Azure-Block-Size, X-Google-Api-Key, X-Google-Vertex-Api-Key, X-Google-Studio-Api-Key, X-Goog-Api-Key, X-Goog-Vertex-Api-Key, X-Goog-Studio-Api-Key, X-Palm-Api-Key, X-Jinaai-Api-Key, X-Aws-Access-Key, X-Aws-Secret-Key, X-Voyageai-Baseurl, X-Voyageai-Api-Key, X-Mistral-Baseurl, X-Mistral-Api-Key, X-Anthropic-Baseurl, X-Anthropic-Api-Key, X-Databricks-Endpoint, X-Databricks-Token, X-Databricks-User-Agent, X-Friendli-Token, X-Friendli-Baseurl, X-Weaviate-Api-Key, X-Weaviate-Cluster-Url, X-Nvidia-Api-Key, X-Nvidia-Baseurl'), (b'access-control-allow-methods', b'*'), (b'access-control-allow-origin', b'*'), (b'content-type', b'application/json'), (b'vary', b'Origin'), (b'date', b'Tue, 02 Sep 2025 17:31:44 GMT'), (b'x-envoy-upstream-service-time', b'10'), (b'server', b'istio-envoy'), (b'Via', b'1.1 google'), (b'Alt-Svc', b'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'), (b'Transfer-Encoding', b'chunked')])
2025-09-02 23:01:44,929 [INFO] HTTP Request: GET https://unv2yy07qfybxgvelndplw.c0.europe-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
2025-09-02 23:01:44,929 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-09-02 23:01:44,929 [DEBUG] receive_response_body.complete
2025-09-02 23:01:44,929 [DEBUG] response_closed.started
2025-09-02 23:01:44,929 [DEBUG] response_closed.complete
